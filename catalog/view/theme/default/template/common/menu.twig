<nav id="menu">
	<div class="container menu-desktop">
		<ul>
		<!--
			<li class="mega-menu">
				<a href="#" class="mega-menu-item">
					<i class="fa fa-bars"></i>
					Todos os Departamentos
				</a>
				<div class="mega-menu-dropdown">
					<div class="mega-menu-container">
						<ul class="mega-menu-list">
							{% for category in allCategories %}
								<li class="mega-menu-category" data-target="submenu-{{ loop.index }}">
									<a href="{{ category.href }}">{{ category.name }}</a>
								</li>
							{% endfor %}
						</ul>
						<div class="mega-menu-subcategories">
							{% for category in allCategories %}
								{% if category.children %}
									<div id="submenu-{{ loop.index }}" class="mega-menu-sub">
										<h3>{{ category.name }}</h3>
										<ul>
											{% for child in category.children %}
												<li>
													<a href="{{ child.href }}">{{ child.name }}</a>
												</li>
											{% endfor %}
										</ul>
									</div>
								{% endif %}
							{% endfor %}
						</div>
					</div>
				</div>
			</li> -->
			{% for category in categories %}
				{% if category.children %}
					<li class="dropdown">
						<a href="{{ category.href }}" class="nav-link dropdown-toggle" data-target="submenu-mobile-{{ loop.index }}">{{ category.name }}</a>
						<ul class="dropdown-menu">
							{% for child in category.children %}
								<li>
									<a href="{{ child.href }}" class="nav-link">{{ child.name }}</a>
								</li>
							{% endfor %}
						</ul>
					</li>
				{% else %}
					<li>
						<a href="{{ category.href }}" class="nav-link">{{ category.name }}</a>
					</li>
				{% endif %}
			{% endfor %}
		</ul>
	</div>
	<span id="menuToggle">Departamentos
		<i class="fa fa-bars"></i>
	</span>
</nav>

<div class="menu-overlay" id="menuOverlay"></div>

<div class="menu-mobile" id="menuMobile">
	<div class="menu-header">

		<h4 class="menu-title">Departamentos</h4>
		<button class="btn btn-link" id="closeMenu">
			<i class="fa fa-times"></i>
		</button>
	</div>
	<ul class="menu-main">
		{% for category in categories %}
			{% if category.children %}
				<li>
					<a href="{{ category.link }}" class="nav-link open-submenu" data-target="submenu-mobile-{{ loop.index }}">{{ category.name }}
						<i class="fa fa-caret-down"></i>
					</a>
					<ul class="submenu" id="submenu-mobile-{{ loop.index }}">
						<li class="d-flex justify-content-start align-items-center gap-3 pb-3 mb-3" style="border-bottom: 1px solid #DDD;">
							<button class="btn btn-link button-backMenu">
								<i class="fa fa-arrow-left"></i>
								Voltar</button>
							<h4 class="m-0">{{ category.name }}</h4>
						</li>
						{% for child in category.children %}
							<li>
								<a href="{{ child.href }}" class="nav-link">{{ child.name }}</a>
							</li>
						{% endfor %}
					</ul>
				</li>
			{% else %}
				<li>
					<a href="{{ category.href }}" class="nav-link">{{ category.name }}</a>
				</li>
			{% endif %}
		{% endfor %}
	</ul>
</div>

 <script>
document.getElementById('menuToggle').addEventListener('click', function () {
    document.getElementById('menuMobile').classList.add('show');
    document.getElementById('menuOverlay').classList.add('show');
});

document.getElementById('closeMenu').addEventListener('click', function () {
    document.getElementById('menuMobile').classList.remove('show');
    document.getElementById('menuOverlay').classList.remove('show');
});

document.getElementById('menuOverlay').addEventListener('click', function () {
    document.getElementById('menuMobile').classList.remove('show');
    document.getElementById('menuOverlay').classList.remove('show');
});

document.querySelectorAll('.open-submenu').forEach(item => {
    item.addEventListener('click', function (e) {
        e.preventDefault();
        let target = document.getElementById(this.getAttribute('data-target'));
        target.classList.toggle('show');
    });
});

$(document).on('click', '.button-backMenu', function () {
    document.querySelectorAll('.submenu.show').forEach(submenu => {
        submenu.classList.remove('show');
    });
});
</script>
